### php curl タイムアウト動作
https://www.php.net/manual/ja/function.curl-setopt.php
 
CURLOPT_CONNECTTIMEOUT
CURLOPT_TIMEOUT

// デフォルト5分のようだが、カーネルプロトコルスタックのTCP制御で2分強でタイムアウトする
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 3);

### curl_setopt 設定値
CURLOPT_CONNECTTIMEOUT ：接続の試行を待ち続ける秒数。0 は永遠に待ち続けることを意味します。
CURLOPT_TIMEOUT：cURL 関数の実行にかけられる時間の最大値。

``` php
  $options = [CURLOPT_URL => $url,
                    CURLOPT_HEADER => true,
                    CURLOPT_CUSTOMREQUEST => 'POST',
                    CURLOPT_RETURNTRANSFER => true,
                    CURLOPT_CONNECTTIMEOUT => 5,
                    CURLOPT_TIMEOUT => 10,
                    CURLOPT_SSL_VERIFYPEER => true ? 0 : 2];
```



--max-time

なお、curlのタイムアウトは2秒を指定します。

$ curl --max-time 2 localhost:8080/sleep

curl -m 2 -o output https://example.com


--retry <num>
失敗時(タイムアウトや5xx)のリトライ回数 (デフォルト 0)
最初は1秒待ってから、次もダメなら2秒待ってから、のように倍々で待ち、最大10分まで伸びる
この辺は --retry-delay と --retry-max-time で指定可能

https://zenn.dev/hijili/articles/e51706653eb118ad6e8e
